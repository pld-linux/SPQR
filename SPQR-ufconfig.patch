--- SPQR/Makefile.orig	2011-12-07 23:20:52.000000000 +0100
+++ SPQR/Makefile	2012-01-07 15:26:12.640442839 +0100
@@ -4,7 +4,7 @@
 
 VERSION = 1.2.3
 
-include ../UFconfig/UFconfig.mk
+include /usr/share/misc/UFconfig.mk
 
 default: all
 
--- SPQR/Lib/Makefile.orig	2011-12-14 18:48:21.000000000 +0100
+++ SPQR/Lib/Makefile	2012-01-07 15:36:22.723796599 +0100
@@ -6,7 +6,7 @@
 
 ccode: all
 
-include ../../UFconfig/UFconfig.mk
+include /usr/share/misc/UFconfig.mk
 
 #-------------------------------------------------------------------------------
 # the optional Partition module requires METIS, CAMD, and CCOLAMD
@@ -14,13 +14,10 @@
 # check if METIS is requested and available
 ifeq (,$(findstring -DNPARTITION, $(CHOLMOD_CONFIG)))
     # METIS is requested.  See if it is available
-    ifeq ($(METIS), $(wildcard $(METIS)))
-        ifeq (../../CAMD, $(wildcard ../../CAMD))
-            ifeq (../../CCOLAMD, $(wildcard ../../CCOLAMD))
+    ifeq ($(WITH_METIS), 1)
+	# assume CAMD and CCOLAMD are available
                 # METIS, CAMD, and CCOLAMD is available
                 CONFIG =
-            endif
-        endif
     endif
 endif
 #-------------------------------------------------------------------------------
@@ -91,7 +88,7 @@
 
 $(OBJ): $(INC)
 
-I = -I../../CHOLMOD/Include -I../../UFconfig -I../Include
+I = -I/usr/include/cholmod -I../Include
 
 C = $(CXX) $(CF) $(SPQR_CONFIG) $(CONFIG) $(I)
 
--- SPQR/Demo/Makefile.orig	2011-12-14 18:48:48.000000000 +0100
+++ SPQR/Demo/Makefile	2012-01-08 12:06:51.122935314 +0100
@@ -6,7 +6,7 @@
 
 ccode: all
 
-include ../../UFconfig/UFconfig.mk
+include /usr/share/misc/UFconfig.mk
 
 #-------------------------------------------------------------------------------
 # the optional Partition module requires METIS, CAMD, and CCOLAMD
@@ -15,23 +15,17 @@
 # check if METIS is requested and available
 ifeq (,$(findstring -DNPARTITION, $(CHOLMOD_CONFIG)))
     # METIS is requested.  See if it is available
-    ifeq ($(METIS), $(wildcard $(METIS)))
-        ifeq (../../CAMD, $(wildcard ../../CAMD))
-            ifeq (../../CCOLAMD, $(wildcard ../../CCOLAMD))
+    ifeq ($(WITH_METIS), 1)
+	# assume CAMD and CCOLAMD are available
                 # METIS, CAMD, and CCOLAMD is available
                 CONFIG =
-                LIB_WITH_PARTITION = $(METIS) \
-                    ../../CCOLAMD/Lib/libccolamd.a \
-                    ../../CAMD/Lib/libcamd.a
-            endif
-        endif
+                LIB_WITH_PARTITION = $(METIS) -lccolamd -lcamd
     endif
 endif
 #-------------------------------------------------------------------------------
 
 CLIB = ../Lib/libspqr.a \
-	../../CHOLMOD/Lib/libcholmod.a ../../AMD/Lib/libamd.a \
-	../../COLAMD/Lib/libcolamd.a $(LIB_WITH_PARTITION) -lm
+	-lcholmod -lamd -lcolamd $(LIB_WITH_PARTITION) -lm
 
 # use the BLAS and LAPACK defined by UFconfig.mk; do not use valgrind 
 FLIB = $(LAPACK) $(BLAS)
@@ -119,7 +113,7 @@
 	../Include/SuiteSparseQR_definitions.h \
 	../Include/SuiteSparseQR.hpp Makefile
 
-I = -I../../CHOLMOD/Include -I../../UFconfig -I../Include
+I = -I/usr/include/cholmod -I../Include
 
 C = $(CXX) $(CF) $(SPQR_CONFIG) $(CONFIG) $(I)
 
